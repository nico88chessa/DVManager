<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
    xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:p="http://primefaces.org/ui">


<h:body>
    
<ui:composition template="/WEB-INF/layout/appLayout.xhtml">

    <ui:define name="content">

        <div id="divDBManagement">
        
            <!-- qui visualizzo il pulsante per aggiungere una nuova macchina -->
            <div class="ui-g">
                <div class="ui-g-12">
                    <h:form>
                        <p:commandButton id="inserisciMacchinaCB" widgetVar="inserisciMacchinaCB"
                            value="Inserisci macchine" icon="ui-icon-star" type="button" onclick="PF('inserisciMacchinaDlg').show();" />
                        
                        <p:dialog id="inserisciMacchinaDlg" widgetVar="inserisciMacchinaDlg"
                            header="Inserisci macchina" modal="true" height="200" width="500" minHeight="200" minWidth="400">
                            
                            <div class="ui-g">
                                
                                <div class="ui-g-6">
                                    <p:outputLabel value="Indirizzo IP" />
                                </div>
                                <div class="ui-g-6">
                                    <p:inputMask id="ipIM" widgetVar="ipIM" mask="9?99.999.999.999" slotChar="0"
                                        value="#{mainBean.newMachineIP}"/>
                                </div>
                                
                                <div class="ui-g-6" style="width=10px">
                                    <p:outputLabel value="Nome macchina" />
                                </div>
                                <div class="ui-g-6">
                                    <p:inputMask id="nomeMacchinaIM" widgetVar="nomeMacchinaIM" slotChar=" "
                                        value="#{mainBean.newMachineName}"/>
                                </div>
                                
                                <div class="ui-g-2">
                                    <p:commandButton id="confermaInserimentoCB" widgetVar="confermaInserimentoCB" value="Inserisci"
                                        onclick="PF('inserisciMacchinaDlg').hide()" actionListener="#{mainCtrl.addNewMachineToDB()}" />
                                </div>
                                <div class="ui-g-2">
                                    <p:commandButton id="annullaInserimentoCB" widgetVar="annullaInserimentoCB" value="Annulla"
                                        onclick="PF('inserisciMacchinaDlg').hide()" />
                                </div>
                                <div class="ui-g-8"/>
                            
                            </div>
    
                        </p:dialog>
                    </h:form> 
                </div>
            
                <!-- questa e' la tabella di visualizzazione dei dati -->
                <div class="ui-g-12">
                    
                    <div id="machinesDiv" class="ui-g">
                        <h:form id="startup">
                            <p:remoteCommand id="rcShowMachineList" actionListener="#{mainCtrl.init}" update="machineForm" autoRun="#{not mainBean.pageLoaded}" />
                        </h:form>
                        
                        <h:form id="machineForm">
                            
                            <p:dialog header="Modal Dialog" widgetVar="dlg10" modal="true" height="100" resizable="false">
                                <p:outputPanel id="dlgDetail" style="text-align:center;">
                                    <p:outputLabel value="This is a Modal Dialog. #{mainBean.selectedMachine.id}" />
                                </p:outputPanel>
                            </p:dialog>
                            
                            <p:growl id="dbGrowl" showDetail="true" />
                            <p:outputLabel value="#{mainBean.name}" />
                            <p:dataTable id="machines" value="#{mainBean.machines}" var="item" editable="true">
                                <p:column headerText="ID">
                                    <p:outputLabel value="#{item.id}" />
                                </p:column>
                                <p:column headerText="Indirizzo IP">
                                    <p:outputLabel value="#{item.ip}" />
                                </p:column>
                                <p:column headerText="Ultimo aggiornamento">
                                    <p:outputLabel value="#{item.lastUpdate}" />
                                </p:column>
                                <p:column>
                                    <p:commandButton value="Modal - #{item.id}" update=":machineForm:dlgDetail" oncomplete="PF('dlg10').show()">
                                        <f:setPropertyActionListener value="#{item}" target="#{mainBean.selectedMachine}" />
                                    </p:commandButton>
                                </p:column>
                                <p:column>
                                    <p:commandButton icon="ui-icon-myCancel" update=":machineForm:dlgDetail" oncomplete="PF('dlg10').show()" style="width:48px; height:48px"
                                        iconPos="left">
                                        <f:setPropertyActionListener value="#{item}" target="#{mainBean.selectedMachine}" />
                                    </p:commandButton>
                                </p:column>
                            </p:dataTable>
    
                        </h:form>
                    
                    </div>

                </div>

                
            </div>
        
        </div>

    </ui:define>

</ui:composition>

</h:body>

</html>